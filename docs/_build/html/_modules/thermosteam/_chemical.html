

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>thermosteam._chemical &mdash; Thermosteam  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Thermosteam
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/Getting_started.html">3. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/Thermodynamic_equilibrium.html">4. Thermodynamic equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/Thermo_property_packages.html">5. Thermo property packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/Stoichiometric_reactions.html">6. Stoichiometric reactions</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Chemical.html">Chemical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Chemicals.html">Chemicals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CompiledChemicals.html">CompiledChemicals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Thermo.html">Thermo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Stream.html">Stream</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../MultiStream.html">MultiStream</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ThermalCondition.html">ThermalCondition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functor.html">functor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../equilibrium/equilibrium_module.html">equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reaction/reaction_module.html">reaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../indexer/indexer_module.html">indexer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exceptions.html">exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functional.html">functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../properties/properties_module.html">properties</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Thermosteam</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>thermosteam._chemical</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for thermosteam._chemical</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Chemical&#39;</span><span class="p">,)</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">thermosteam</span> <span class="k">as</span> <span class="nn">tmo</span>
<span class="kn">from</span> <span class="nn">flexsolve</span> <span class="kn">import</span> <span class="n">IQ_interpolation</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">copy_maybe</span>
<span class="kn">from</span> <span class="nn">.properties.identifiers</span> <span class="kn">import</span> <span class="n">CAS_from_any</span><span class="p">,</span> <span class="n">pubchem_db</span>
<span class="kn">from</span> <span class="nn">.properties.vapor_pressure</span> <span class="kn">import</span> <span class="n">VaporPressure</span>
<span class="kn">from</span> <span class="nn">.properties.phase_change</span> <span class="kn">import</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">Hfus</span><span class="p">,</span> <span class="n">Hsub</span><span class="p">,</span> <span class="n">EnthalpyVaporization</span>
<span class="kn">from</span> <span class="nn">.properties.critical</span> <span class="kn">import</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">Vc</span>
<span class="kn">from</span> <span class="nn">.properties.acentric</span> <span class="kn">import</span> <span class="n">omega</span><span class="p">,</span> <span class="n">StielPolar</span>
<span class="kn">from</span> <span class="nn">.properties.triple</span> <span class="kn">import</span> <span class="n">Tt</span><span class="p">,</span> <span class="n">Pt</span>
<span class="kn">from</span> <span class="nn">.properties.volume</span> <span class="kn">import</span> <span class="n">Volume</span>
<span class="kn">from</span> <span class="nn">.properties.heat_capacity</span> <span class="kn">import</span> <span class="n">HeatCapacity</span>
<span class="kn">from</span> <span class="nn">.properties.reaction</span> <span class="kn">import</span> <span class="n">Hf</span>
<span class="kn">from</span> <span class="nn">.properties.combustion</span> <span class="kn">import</span> <span class="n">CombustionData</span>
<span class="kn">from</span> <span class="nn">.properties.elements</span> <span class="kn">import</span> <span class="n">compute_similarity_variable</span><span class="p">,</span> <span class="n">parse_simple_formula</span>
<span class="kn">from</span> <span class="nn">.properties.eos</span> <span class="kn">import</span> <span class="n">GCEOS_DUMMY</span><span class="p">,</span> <span class="n">PR</span>
<span class="kn">from</span> <span class="nn">.properties.viscosity</span> <span class="kn">import</span> <span class="n">Viscosity</span>
<span class="kn">from</span> <span class="nn">.properties.thermal_conductivity</span> <span class="kn">import</span> <span class="n">ThermalConductivity</span>
<span class="kn">from</span> <span class="nn">.properties.free_energy</span> <span class="kn">import</span> \
    <span class="n">EnthalpyRefSolid</span><span class="p">,</span> <span class="n">EnthalpyRefLiquid</span><span class="p">,</span> <span class="n">EnthalpyRefGas</span><span class="p">,</span> \
    <span class="n">EntropyRefSolid</span><span class="p">,</span> <span class="n">EntropyRefLiquid</span><span class="p">,</span> <span class="n">EntropyRefGas</span><span class="p">,</span> \
    <span class="n">ExcessEnthalpyRefSolid</span><span class="p">,</span> <span class="n">ExcessEnthalpyRefLiquid</span><span class="p">,</span> <span class="n">ExcessEnthalpyRefGas</span><span class="p">,</span> \
    <span class="n">ExcessEntropyRefSolid</span><span class="p">,</span> <span class="n">ExcessEntropyRefLiquid</span><span class="p">,</span> <span class="n">ExcessEntropyRefGas</span>
<span class="kn">from</span> <span class="nn">.base</span> <span class="kn">import</span> <span class="n">PhaseProperty</span><span class="p">,</span> <span class="n">PhaseTProperty</span><span class="p">,</span> <span class="n">PhaseTPProperty</span><span class="p">,</span> \
                  <span class="n">display_asfunctor</span><span class="p">,</span> <span class="n">TDependentModelHandle</span><span class="p">,</span> <span class="n">TPDependentModelHandle</span>
<span class="kn">from</span> <span class="nn">.base.units_of_measure</span> <span class="kn">import</span> <span class="n">chemical_units_of_measure</span>
<span class="kn">from</span> <span class="nn">.properties.dipole</span> <span class="kn">import</span> <span class="n">dipole_moment</span> <span class="k">as</span> <span class="n">dipole</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">functional</span> <span class="k">as</span> <span class="n">fn</span> 
<span class="kn">from</span> <span class="nn">.properties.permittivity</span> <span class="kn">import</span> <span class="n">Permittivity</span>
<span class="kn">from</span> <span class="nn">.properties.interface</span> <span class="kn">import</span> <span class="n">SurfaceTension</span>
<span class="kn">from</span> <span class="nn">.equilibrium.unifac_data</span> <span class="kn">import</span> \
    <span class="n">DDBST_UNIFAC_assignments</span><span class="p">,</span> <span class="n">DDBST_MODIFIED_UNIFAC_assignments</span><span class="p">,</span> <span class="n">DDBST_PSRK_assignments</span><span class="p">,</span> \
    <span class="n">UNIFACGroupCounts</span><span class="p">,</span> <span class="n">DortmundGroupCounts</span><span class="p">,</span> <span class="n">PSRKGroupCounts</span>
<span class="c1"># from .solubility import SolubilityParameter</span>
<span class="c1"># from .safety import Tflash, Tautoignition, LFL, UFL, TWA, STEL, Ceiling, Skin, Carcinogen</span>
<span class="c1"># from .lennard_jones import Stockmayer, MolecularDiameter</span>
<span class="c1"># from .environment import GWP, ODP, logP</span>
<span class="c1"># from .refractivity import refractive_index</span>
<span class="c1"># from .electrochem import conductivity</span>

<span class="c1"># %% Search tools</span>

<span class="k">def</span> <span class="nf">to_searchable_format</span><span class="p">(</span><span class="n">ID</span><span class="p">):</span>    
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\B([A-Z])&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot; \1&quot;</span><span class="p">,</span> <span class="n">ID</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>


<span class="c1"># %% Filling missing properties</span>

<span class="k">def</span> <span class="nf">fill_from_dict</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">slots</span><span class="p">:</span> <span class="n">slots</span> <span class="o">=</span> <span class="n">chemical</span><span class="o">.</span><span class="n">get_missing_slots</span><span class="p">(</span><span class="n">slots</span><span class="p">)</span>
    <span class="n">missing</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">setfield</span> <span class="o">=</span> <span class="nb">setattr</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">slots</span> <span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="n">setfield</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">missing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">missing</span>

<span class="k">def</span> <span class="nf">fill_from_obj</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">slots</span><span class="p">:</span> <span class="n">slots</span> <span class="o">=</span> <span class="n">chemical</span><span class="o">.</span><span class="n">get_missing_slots</span><span class="p">(</span><span class="n">slots</span><span class="p">)</span>
    <span class="n">missing</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">setfield</span> <span class="o">=</span> <span class="nb">setattr</span>
    <span class="n">getfield</span> <span class="o">=</span> <span class="nb">getattr</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">getfield</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field</span><span class="p">:</span>
            <span class="n">setfield</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">missing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">missing</span>

<span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">fill</span> <span class="o">=</span> <span class="n">fill_from_dict</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="n">fill_from_obj</span>
    <span class="k">return</span> <span class="n">fill</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">slots</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_chemical_data</span><span class="p">(</span><span class="n">chemical</span><span class="p">):</span>
    <span class="n">getfield</span> <span class="o">=</span> <span class="nb">getattr</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">getfield</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">chemical</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">unpickle_chemical</span><span class="p">(</span><span class="n">chemical_data</span><span class="p">):</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">Chemical</span><span class="o">.</span><span class="n">_cache</span>
    <span class="n">CAS</span> <span class="o">=</span> <span class="n">chemical_data</span><span class="p">[</span><span class="s1">&#39;_CAS&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">CAS</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
        <span class="n">chemical</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="n">CAS</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">chemical</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">Chemical</span><span class="p">)</span>
        <span class="n">setfield</span> <span class="o">=</span> <span class="nb">setattr</span>
        <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">chemical_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">setfield</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">chemical</span>

<span class="c1"># %% Representation</span>
    
<span class="k">def</span> <span class="nf">chemical_identity</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">pretty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">typeheader</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">chemical</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:&quot;</span>
    <span class="n">full_ID</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">typeheader</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">chemical</span><span class="o">.</span><span class="n">ID</span><span class="si">}</span><span class="s2"> (phase_ref=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">chemical</span><span class="o">.</span><span class="n">phase_ref</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">chemical</span><span class="o">.</span><span class="n">locked_state</span>
    <span class="n">state</span> <span class="o">=</span> <span class="s1">&#39; at &#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;phase=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">phase</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="n">full_ID</span> <span class="o">+</span> <span class="n">state</span>


<span class="c1"># %% Initialize EOS</span>
                         
<span class="k">def</span> <span class="nf">create_eos</span><span class="p">(</span><span class="n">eos</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span> <span class="k">return</span> <span class="n">eos</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="mf">101325.</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="o">=</span><span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="n">omega</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">return</span> <span class="n">GCEOS_DUMMY</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="mf">101325.</span><span class="p">)</span>


<span class="c1"># %% Chemical fields</span>

<span class="n">_names</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_CAS&#39;</span><span class="p">,</span> <span class="s1">&#39;InChI&#39;</span><span class="p">,</span> <span class="s1">&#39;InChI_key&#39;</span><span class="p">,</span>
         <span class="s1">&#39;common_name&#39;</span><span class="p">,</span> <span class="s1">&#39;iupac_name&#39;</span><span class="p">,</span>
         <span class="s1">&#39;pubchemid&#39;</span><span class="p">,</span> <span class="s1">&#39;smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;formula&#39;</span><span class="p">)</span>

<span class="n">_groups</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Dortmund&#39;</span><span class="p">,</span> <span class="s1">&#39;UNIFAC&#39;</span><span class="p">,</span> <span class="s1">&#39;PSRK&#39;</span><span class="p">)</span>

<span class="n">_reactions</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;combustion&#39;</span><span class="p">,)</span>

<span class="n">_thermo</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;S_excess&#39;</span><span class="p">,</span> <span class="s1">&#39;H_excess&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;kappa&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;Cn&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Psat&#39;</span><span class="p">,</span> <span class="s1">&#39;Hvap&#39;</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;epsilon&#39;</span><span class="p">)</span>
    
<span class="n">_phase_properties</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;kappa&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;Cn&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">)</span>

<span class="n">_free_energies</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;S_excess&#39;</span><span class="p">,</span> <span class="s1">&#39;H_excess&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">)</span>

<span class="n">_liquid_only_properties</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;epsilon&#39;</span><span class="p">)</span>

<span class="n">_equilibrium_properties</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Psat&#39;</span><span class="p">,</span> <span class="s1">&#39;Hvap&#39;</span><span class="p">)</span>

<span class="n">_data</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;MW&#39;</span><span class="p">,</span> <span class="s1">&#39;Tm&#39;</span><span class="p">,</span> <span class="s1">&#39;Tb&#39;</span><span class="p">,</span> <span class="s1">&#39;Tt&#39;</span><span class="p">,</span> <span class="s1">&#39;Tc&#39;</span><span class="p">,</span> <span class="s1">&#39;Pt&#39;</span><span class="p">,</span> <span class="s1">&#39;Pc&#39;</span><span class="p">,</span> <span class="s1">&#39;Vc&#39;</span><span class="p">,</span> <span class="s1">&#39;Zc&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Hf&#39;</span><span class="p">,</span> <span class="s1">&#39;LHV&#39;</span><span class="p">,</span> <span class="s1">&#39;HHV&#39;</span><span class="p">,</span> <span class="s1">&#39;Hfus&#39;</span><span class="p">,</span> <span class="s1">&#39;Hsub&#39;</span><span class="p">,</span> <span class="s1">&#39;omega&#39;</span><span class="p">,</span> <span class="s1">&#39;dipole&#39;</span><span class="p">,</span>
         <span class="s1">&#39;StielPolar&#39;</span><span class="p">,</span> <span class="s1">&#39;similarity_variable&#39;</span><span class="p">,</span> <span class="s1">&#39;iscyclic_aliphatic&#39;</span><span class="p">)</span>

<span class="n">_checked_slots</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;phase_ref&#39;</span><span class="p">,</span> <span class="s1">&#39;eos&#39;</span><span class="p">,</span> <span class="s1">&#39;eos_1atm&#39;</span><span class="p">,</span>
                  <span class="o">*</span><span class="n">_names</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="o">*</span><span class="n">_groups</span><span class="p">,</span> <span class="o">*</span><span class="n">_reactions</span><span class="p">,</span>
                  <span class="o">*</span><span class="n">_thermo</span><span class="p">,</span> <span class="o">*</span><span class="n">_data</span><span class="p">)</span>

<span class="n">_chemical_fields</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">[Names]  &#39;</span><span class="p">:</span> <span class="n">_names</span><span class="p">,</span>
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">[Groups] &#39;</span><span class="p">:</span> <span class="n">_groups</span><span class="p">,</span>
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">[Thermo] &#39;</span><span class="p">:</span> <span class="n">_thermo</span><span class="p">,</span>
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">[Data]   &#39;</span><span class="p">:</span> <span class="n">_data</span><span class="p">}</span>


<span class="c1"># %% Chemical</span>

<div class="viewcode-block" id="Chemical"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical">[docs]</a><span class="k">class</span> <span class="nc">Chemical</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a Chemical object which contains basic information such as </span>
<span class="sd">    molecular weight and the structure of the species, as well as thermodynamic</span>
<span class="sd">    and transport properties as a function of temperature and pressure.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ID : str</span>
<span class="sd">        One of the following [-]:</span>
<span class="sd">            * Name, in IUPAC form or common form or a synonym registered in PubChem</span>
<span class="sd">            * InChI name, prefixed by &#39;InChI=1S/&#39; or &#39;InChI=1/&#39;</span>
<span class="sd">            * InChI key, prefixed by &#39;InChIKey=&#39;</span>
<span class="sd">            * PubChem CID, prefixed by &#39;PubChem=&#39;</span>
<span class="sd">            * SMILES (prefix with &#39;SMILES=&#39; to ensure smiles parsing)</span>
<span class="sd">            * CAS number</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Chemical objects contain pure component properties:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; import thermosteam as tmo</span>
<span class="sd">    &gt;&gt;&gt; # Initialize with an identifier</span>
<span class="sd">    &gt;&gt;&gt; # (e.g. by name, CAS, InChI...)</span>
<span class="sd">    &gt;&gt;&gt; Water = tmo.Chemical(&#39;Water&#39;) </span>
<span class="sd">    &gt;&gt;&gt; Water.show()</span>
<span class="sd">    Chemical: Water (phase_ref=&#39;l&#39;)</span>
<span class="sd">    [Names]  CAS: 7732-18-5</span>
<span class="sd">             InChI: H2O/h1H2</span>
<span class="sd">             InChI_key: XLYOFNOQVPJJNP-U...</span>
<span class="sd">             common_name: water</span>
<span class="sd">             iupac_name: oxidane</span>
<span class="sd">             pubchemid: 962</span>
<span class="sd">             smiles: O</span>
<span class="sd">             formula: H2O</span>
<span class="sd">    [Groups] Dortmund: &lt;1H2O&gt;</span>
<span class="sd">             UNIFAC: &lt;1H2O&gt;</span>
<span class="sd">             PSRK: &lt;1H2O&gt;</span>
<span class="sd">    [Thermo] S_excess(phase, T, P) -&gt; J/mol</span>
<span class="sd">             H_excess(phase, T, P) -&gt; J/mol</span>
<span class="sd">             mu(phase, T, P) -&gt; Pa*s</span>
<span class="sd">             kappa(phase, T, P) -&gt; W/m/K</span>
<span class="sd">             V(phase, T, P) -&gt; m^3/mol</span>
<span class="sd">             S(phase, T, P) -&gt; J/mol</span>
<span class="sd">             H(phase, T) -&gt; J/mol</span>
<span class="sd">             Cn(phase, T) -&gt; J/mol/K</span>
<span class="sd">             Psat(T, P=None) -&gt; Pa</span>
<span class="sd">             Hvap(T, P=None) -&gt; J/mol</span>
<span class="sd">             sigma(T, P=None) -&gt; N/m</span>
<span class="sd">             epsilon(T, P=None)</span>
<span class="sd">    [Data]   MW: 18.015 g/mol</span>
<span class="sd">             Tm: 273.15 K</span>
<span class="sd">             Tb: 373.12 K</span>
<span class="sd">             Tt: 273.15 K</span>
<span class="sd">             Tc: 647.14 K</span>
<span class="sd">             Pt: None</span>
<span class="sd">             Pc: 2.2048e+07 Pa</span>
<span class="sd">             Vc: 5.6e-05 m^3/mol</span>
<span class="sd">             Zc: 0.22947</span>
<span class="sd">             Hf: -2.4182e+05 J/mol</span>
<span class="sd">             LHV: 0</span>
<span class="sd">             HHV: 0</span>
<span class="sd">             Hfus: 6010 J/mol</span>
<span class="sd">             Hsub: None</span>
<span class="sd">             omega: 0.344</span>
<span class="sd">             dipole: 1.85 Debye</span>
<span class="sd">             StielPolar: None</span>
<span class="sd">             similarity_variable: 0.16653</span>
<span class="sd">             iscyclic_aliphatic: 0</span>

<span class="sd">    All fields shown are accessible:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; Water.CAS</span>
<span class="sd">    &#39;7732-18-5&#39;</span>

<span class="sd">    Functional group identifiers (e.g. `Dortmund`, `UNIFAC`, `PSRK`) allow for the estimation of activity coefficients through group contribution methods. In other words, these attributes define the functional groups for thermodynamic equilibrium calculations:</span>
<span class="sd">        </span>
<span class="sd">    &gt;&gt;&gt; Water.Dortmund</span>
<span class="sd">    &lt;DortmundGroupCounts: 1H2O&gt;</span>
<span class="sd">    </span>
<span class="sd">    Temperature (in Kelvin) and pressure (in Pascal) dependent properties can be computed:</span>
<span class="sd">        </span>
<span class="sd">    &gt;&gt;&gt; # Vapor pressure (Pa)</span>
<span class="sd">    &gt;&gt;&gt; Water.Psat(T=373.15)</span>
<span class="sd">    101284.55179999319</span>
<span class="sd">    &gt;&gt;&gt; # Surface tension (N/m)</span>
<span class="sd">    &gt;&gt;&gt; Water.sigma(T=298.15)</span>
<span class="sd">    0.07205503890847455</span>
<span class="sd">    &gt;&gt;&gt; # Molar volume (m^3/mol)</span>
<span class="sd">    &gt;&gt;&gt; Water.V(phase=&#39;l&#39;, T=298.15, P=101325)</span>
<span class="sd">    1.802828527066713e-05</span>
<span class="sd">    </span>
<span class="sd">    Note that the reference state of all chemicals is 25 degC and 1 atm:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; (Water.T_ref, Water.P_ref)</span>
<span class="sd">    (298.15, 101325.0)</span>
<span class="sd">    &gt;&gt;&gt; # Enthalpy at reference conditions (J/mol; without excess energies)</span>
<span class="sd">    &gt;&gt;&gt; Water.H(T=298.15, phase=&#39;l&#39;)</span>
<span class="sd">    0.0</span>
<span class="sd">    </span>
<span class="sd">    Constant pure component properties are also available:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; # Molecular weight (g/mol)</span>
<span class="sd">    &gt;&gt;&gt; Water.MW</span>
<span class="sd">    18.01528</span>
<span class="sd">    &gt;&gt;&gt; # Boiling point (K)</span>
<span class="sd">    &gt;&gt;&gt; Water.Tb</span>
<span class="sd">    373.124</span>
<span class="sd">    </span>
<span class="sd">    Temperature dependent properties are managed by model handles:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; Water.Psat.show()</span>
<span class="sd">    TDependentModelHandle(T, P=None) -&gt; Psat [Pa]</span>
<span class="sd">    [0] Wagner_McGraw</span>
<span class="sd">    [1] Antoine</span>
<span class="sd">    [2] DIPPR_EQ101</span>
<span class="sd">    [3] Wagner</span>
<span class="sd">    [4] Boiling_Critical_Relation</span>
<span class="sd">    [5] Lee_Kesler</span>
<span class="sd">    [6] Ambrose_Walton</span>
<span class="sd">    [7] Sanjari</span>
<span class="sd">    [8] Edalat</span>

<span class="sd">    Phase dependent properties have attributes with model handles for each phase:</span>

<span class="sd">    &gt;&gt;&gt; Water.V</span>
<span class="sd">    &lt;PhaseTPProperty(phase, T, P) -&gt; V [m^3/mol]&gt;</span>
<span class="sd">    &gt;&gt;&gt; (Water.V.l, Water.V.g)</span>
<span class="sd">    (&lt;TPDependentModelHandle(T, P) -&gt; V.l [m^3/mol]&gt;, &lt;TPDependentModelHandle(T, P) -&gt; V.g [m^3/mol]&gt;)</span>

<span class="sd">    A model handle contains a series of models applicable to a certain domain:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; Water.Psat[0].show()</span>
<span class="sd">    TDependentModel: Wagner_McGraw</span>
<span class="sd">     evaluate: Wagner_McGraw(T, P=None) -&gt; Psat [Pa]</span>
<span class="sd">     Tmin: 275.00</span>
<span class="sd">     Tmax: 647.35</span>

<span class="sd">    When called, the model handle searches through each model until it finds one with an applicable domain. If none are applicable, a value error is raised:</span>
<span class="sd">        </span>
<span class="sd">    &gt;&gt;&gt; Water.Psat(373.15)</span>
<span class="sd">    101284.55179999319</span>
<span class="sd">    &gt;&gt;&gt; # Water.Psat(1000.0) -&gt;</span>
<span class="sd">    &gt;&gt;&gt; # ValueError: &lt;TDependentModelHandle(T, P=None) -&gt; Psat [Pa]&gt;</span>
<span class="sd">    &gt;&gt;&gt; # contains no valid model at T=1000.00 K</span>
<span class="sd">    </span>
<span class="sd">    Model handles as well as the models themselves have tabulation and plotting methods to help visualize how properties depend on temperature and pressure.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; # Water.Psat.plot_vs_T([Water.Tm, Water.Tb], &#39;degC&#39;, &#39;atm&#39;, label=&quot;Water&quot;)</span>
<span class="sd">    </span>
<span class="sd">    .. figure:: ./images/Water_Psat_vs_T.png</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; # Plot all models</span>
<span class="sd">    &gt;&gt;&gt; # Water.Psat.plot_models_vs_T([Water.Tm, Water.Tb], &#39;degC&#39;, &#39;atm&#39;)</span>
<span class="sd">    </span>
<span class="sd">    .. figure:: ./images/Water_all_models_Psat_vs_T.png</span>
<span class="sd">    </span>
<span class="sd">    Each model may contain either a function or a functor (a function with stored data) to compute the property:</span>
<span class="sd">        </span>
<span class="sd">    &gt;&gt;&gt; functor = Water.Psat[0].evaluate</span>
<span class="sd">    &gt;&gt;&gt; functor.show()</span>
<span class="sd">    Functor: Wagner_McGraw(T, P=None) -&gt; Psat [Pa]</span>
<span class="sd">     Tc: 647.35 K</span>
<span class="sd">     Pc: 2.2122e+07 Pa</span>
<span class="sd">     a: -7.7645</span>
<span class="sd">     b: 1.4584</span>
<span class="sd">     c: -2.7758</span>
<span class="sd">     d: -1.233</span>
<span class="sd">    </span>
<span class="sd">    .. Note::</span>
<span class="sd">       All chemical property functors are available in the thermosteam.properties subpackage. You can also use help(&lt;functor&gt;) for further information on the math and equations used in the functor.</span>
<span class="sd">    </span>
<span class="sd">    A new model can be added easily to a model handle through the `add_model` method, for example:</span>
<span class="sd">        </span>
<span class="sd">    &gt;&gt;&gt; # Set top_priority=True to place model in postion [0]</span>
<span class="sd">    &gt;&gt;&gt; @Water.Psat.add_model(Tmin=273.20, Tmax=473.20, top_priority=True)</span>
<span class="sd">    ... def User_antoine_model(T):</span>
<span class="sd">    ...     return 10.0**(10.116 -  1687.537 / (T + 42.98))</span>
<span class="sd">    &gt;&gt;&gt; Water.Psat.show()</span>
<span class="sd">    TDependentModelHandle(T, P=None) -&gt; Psat [Pa]</span>
<span class="sd">    [0] User_antoine_model</span>
<span class="sd">    [1] Wagner_McGraw</span>
<span class="sd">    [2] Antoine</span>
<span class="sd">    [3] DIPPR_EQ101</span>
<span class="sd">    [4] Wagner</span>
<span class="sd">    [5] Boiling_Critical_Relation</span>
<span class="sd">    [6] Lee_Kesler</span>
<span class="sd">    [7] Ambrose_Walton</span>
<span class="sd">    [8] Sanjari</span>
<span class="sd">    [9] Edalat</span>

<span class="sd">    The `add_model` method is a high level interface that even lets you create a constant model:</span>
<span class="sd">        </span>
<span class="sd">    &gt;&gt;&gt; value = Water.V.l.add_model(1.687e-05)</span>
<span class="sd">    ... # Model is appended at the end by default</span>
<span class="sd">    &gt;&gt;&gt; added_model = Water.V.l[-1] </span>
<span class="sd">    &gt;&gt;&gt; added_model.show()</span>
<span class="sd">    ConstantThermoModel: Constant</span>
<span class="sd">     value: 1.687e-05</span>
<span class="sd">     Tmin: 0 K</span>
<span class="sd">     Tmax: inf K</span>
<span class="sd">     Pmin: 0 Pa</span>
<span class="sd">     Pmax: inf Pa</span>

<span class="sd">    .. Note::</span>
<span class="sd">       Because no bounds were given, the model assumes it is valid across all temperatures and pressures.</span>

<span class="sd">    Manage the model order with the `set_model_priority` and `move_up_model_priority` methods:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; # Note: In this case, we pass the model name, but its</span>
<span class="sd">    &gt;&gt;&gt; # also possible to pass the current index, or the model itself.</span>
<span class="sd">    &gt;&gt;&gt; Water.Psat.move_up_model_priority(&#39;Wagner_McGraw&#39;)</span>
<span class="sd">    &gt;&gt;&gt; Water.Psat.show()</span>
<span class="sd">    TDependentModelHandle(T, P=None) -&gt; Psat [Pa]</span>
<span class="sd">    [0] Wagner_McGraw</span>
<span class="sd">    [1] Antoine</span>
<span class="sd">    [2] DIPPR_EQ101</span>
<span class="sd">    [3] Wagner</span>
<span class="sd">    [4] Boiling_Critical_Relation</span>
<span class="sd">    [5] Lee_Kesler</span>
<span class="sd">    [6] Ambrose_Walton</span>
<span class="sd">    [7] Sanjari</span>
<span class="sd">    [8] Edalat</span>
<span class="sd">    [9] User_antoine_model</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; Water.Psat.set_model_priority(&#39;Antoine&#39;)</span>
<span class="sd">    &gt;&gt;&gt; Water.Psat.show()</span>
<span class="sd">    TDependentModelHandle(T, P=None) -&gt; Psat [Pa]</span>
<span class="sd">    [0] Antoine</span>
<span class="sd">    [1] Wagner_McGraw</span>
<span class="sd">    [2] DIPPR_EQ101</span>
<span class="sd">    [3] Wagner</span>
<span class="sd">    [4] Boiling_Critical_Relation</span>
<span class="sd">    [5] Lee_Kesler</span>
<span class="sd">    [6] Ambrose_Walton</span>
<span class="sd">    [7] Sanjari</span>
<span class="sd">    [8] Edalat</span>
<span class="sd">    [9] User_antoine_model</span>
<span class="sd">    </span>
<span class="sd">    The default priority is `0` (or top priority), but you can choose any priority:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; Water.Psat.set_model_priority(&#39;Antoine&#39;, 1)</span>
<span class="sd">    &gt;&gt;&gt; Water.Psat.show()</span>
<span class="sd">    TDependentModelHandle(T, P=None) -&gt; Psat [Pa]</span>
<span class="sd">    [0] Wagner_McGraw</span>
<span class="sd">    [1] Antoine</span>
<span class="sd">    [2] DIPPR_EQ101</span>
<span class="sd">    [3] Wagner</span>
<span class="sd">    [4] Boiling_Critical_Relation</span>
<span class="sd">    [5] Lee_Kesler</span>
<span class="sd">    [6] Ambrose_Walton</span>
<span class="sd">    [7] Sanjari</span>
<span class="sd">    [8] Edalat</span>
<span class="sd">    [9] User_antoine_model</span>
<span class="sd">    </span>
<span class="sd">    .. note::</span>
<span class="sd">    </span>
<span class="sd">        All models are stored as a `deque &lt;https://docs.python.org/3.8/library/collections.html#collections.deque&gt;`_ in the `models` attribute (e.g. Water.Psat.models).</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    InChI : str</span>
<span class="sd">        IUPAC International Chemical Identifier.</span>
<span class="sd">    InChI_key : str</span>
<span class="sd">        IUPAC International Chemical Identifier shorthand.</span>
<span class="sd">    common_name : str</span>
<span class="sd">        Common name identifier.</span>
<span class="sd">    iupac_name : str</span>
<span class="sd">        Standard name as defined by IUPAC.</span>
<span class="sd">    pubchemid : str</span>
<span class="sd">        Chemical identifier as defined by PubMed.</span>
<span class="sd">    smiles : str</span>
<span class="sd">        Chemical SMILES formula.</span>
<span class="sd">    Dortmund : DortmundGroupCounts</span>
<span class="sd">        Dictionary-like object with functional group numerical</span>
<span class="sd">        identifiers as keys and the number of groups as values.</span>
<span class="sd">    UNIFAC : UNIFACGroupCounts</span>
<span class="sd">        Dictionary-like object with functional group numerical</span>
<span class="sd">        identifiers as keys and the number of groups as values.</span>
<span class="sd">    PSRK : PSRKGroupCounts</span>
<span class="sd">        Dictionary-like object with functional group numerical</span>
<span class="sd">        identifiers as keys and the number of groups as values.</span>
<span class="sd">    mu(phase, T, P) : </span>
<span class="sd">        Dynamic viscosity functor [Pa*s].</span>
<span class="sd">    kappa(phase, T, P): </span>
<span class="sd">        Thermal conductivity functor [W/m/K].</span>
<span class="sd">    V(phase, T, P): </span>
<span class="sd">        Molar volume functor [m^3/mol].</span>
<span class="sd">    Cn(phase, T) : </span>
<span class="sd">        Molar heat capacity functor [J/mol/K].</span>
<span class="sd">    Psat(T) : </span>
<span class="sd">        Vapor pressure functor [Pa].</span>
<span class="sd">    Hvap(T) : </span>
<span class="sd">        Heat of vaporization functor [J/mol]</span>
<span class="sd">    sigma(T) : </span>
<span class="sd">        Surface tension functor [N/m].</span>
<span class="sd">    epsilon : </span>
<span class="sd">        Relative permitivity functor [-]</span>
<span class="sd">    S(phase, T, P) : </span>
<span class="sd">        Entropy functor [J/mol].</span>
<span class="sd">    H(phase, T) : </span>
<span class="sd">        Enthalpy functor [J/mol].</span>
<span class="sd">    S_excess(T, P) : </span>
<span class="sd">        Excess entropy functor [J/mol].</span>
<span class="sd">    H_excess(T, P) : </span>
<span class="sd">        Excess enthalpy functor [J/mol].</span>
<span class="sd">    phase_ref : {&#39;s&#39;, &#39;l&#39;, &#39;g&#39;}</span>
<span class="sd">        Phase at 298 K and 101325 Pa.</span>
<span class="sd">    MW : float</span>
<span class="sd">        Molecular weight [g/mol].</span>
<span class="sd">    Tm : float</span>
<span class="sd">        Normal melting temperature [K].</span>
<span class="sd">    Tb : float</span>
<span class="sd">        Normal boiling temperature [K].</span>
<span class="sd">    Tt : float</span>
<span class="sd">        Triple point temperature [K].</span>
<span class="sd">    Tc : float</span>
<span class="sd">        Critical point temperature [K].</span>
<span class="sd">    Pt : float</span>
<span class="sd">        Triple point pressure [Pa].</span>
<span class="sd">    Pc : float</span>
<span class="sd">        Critical point pressure [Pa].</span>
<span class="sd">    Vc : float</span>
<span class="sd">        Critical point molar volume [m^3/mol].</span>
<span class="sd">    Zc : float</span>
<span class="sd">        Critical point molar volume [m^3/mol].</span>
<span class="sd">    Hf : float</span>
<span class="sd">        Heat of formation [J/mol].</span>
<span class="sd">    LHV : float</span>
<span class="sd">        Lower heating value [J/mol].</span>
<span class="sd">    HHV : float</span>
<span class="sd">        Higher heating value [J/mol].</span>
<span class="sd">    Hfus : float</span>
<span class="sd">        Heat of fusion [J/mol].</span>
<span class="sd">    Hsub : float</span>
<span class="sd">        Heat of sublimation [J/mol].</span>
<span class="sd">    omega :</span>
<span class="sd">        Accentric factor [-].</span>
<span class="sd">    dipole : float</span>
<span class="sd">        Dipole moment [Debye].</span>
<span class="sd">    StielPolar : float</span>
<span class="sd">        Stiel Polar factor [-].</span>
<span class="sd">    similarity_variable : float</span>
<span class="sd">        Similarity variable [-].</span>
<span class="sd">    iscyclic_aliphatic : bool</span>
<span class="sd">        Whether the chemical is cyclic-aliphatic.</span>
<span class="sd">    eos : object</span>
<span class="sd">        Instance for solving equations of state.</span>
<span class="sd">    eos_1atm : object</span>
<span class="sd">        Instance for solving equations of state at 1 atm.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;_locked_state&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;phase_ref&#39;</span><span class="p">,</span> <span class="s1">&#39;eos&#39;</span><span class="p">,</span> <span class="s1">&#39;eos_1atm&#39;</span><span class="p">,</span>
                 <span class="o">*</span><span class="n">_names</span><span class="p">,</span> <span class="o">*</span><span class="n">_groups</span><span class="p">,</span> <span class="o">*</span><span class="n">_reactions</span><span class="p">,</span>
                 <span class="o">*</span><span class="n">_thermo</span><span class="p">,</span> <span class="o">*</span><span class="n">_data</span><span class="p">)</span>
    
    <span class="c1">#: [float] Reference temperature in Kelvin</span>
    <span class="n">T_ref</span> <span class="o">=</span> <span class="mf">298.15</span>
    <span class="c1">#: [float] Reference pressure in Pascal</span>
    <span class="n">P_ref</span> <span class="o">=</span> <span class="mf">101325.</span>
    <span class="c1">#: [float] Reference enthalpy in J/mol</span>
    <span class="n">H_ref</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="c1">#: [float] Reference entropy in J/mol</span>
    <span class="n">S_ref</span> <span class="o">=</span> <span class="mf">0.</span>
    
    <span class="n">_cache</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">search_ID</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eos</span><span class="o">=</span><span class="n">PR</span><span class="p">,</span> <span class="n">phase_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">cache</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_cache</span>
        <span class="n">search_ID</span> <span class="o">=</span> <span class="n">search_ID</span> <span class="ow">or</span> <span class="n">ID</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">CAS</span> <span class="o">=</span> <span class="n">CAS_from_any</span><span class="p">(</span><span class="n">search_ID</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">Error</span><span class="p">:</span>
            <span class="n">search_ID</span> <span class="o">=</span> <span class="n">to_searchable_format</span><span class="p">(</span><span class="n">search_ID</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span> <span class="n">CAS</span> <span class="o">=</span> <span class="n">CAS_from_any</span><span class="p">(</span><span class="n">search_ID</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span> <span class="k">raise</span> <span class="n">Error</span>
            
        <span class="k">if</span> <span class="n">CAS</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="n">CAS</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ID</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ID</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
                    <span class="bp">self</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cache</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ID</span><span class="o">=</span><span class="n">ID</span><span class="p">,</span> <span class="n">CAS</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CAS</span><span class="p">)</span>                    
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ID</span> <span class="o">=</span> <span class="n">ID</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_chemical</span><span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">eos</span><span class="p">,</span> <span class="n">phase_ref</span><span class="p">)</span>
            <span class="n">cache</span><span class="p">[</span><span class="n">CAS</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="Chemical.load_chemical"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.load_chemical">[docs]</a>    <span class="k">def</span> <span class="nf">load_chemical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CAS</span><span class="p">,</span> <span class="n">eos</span><span class="o">=</span><span class="n">PR</span><span class="p">,</span> <span class="n">phase_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load all chemical properties.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        CAS : str</span>
<span class="sd">            CAS number of chemical to load.</span>
<span class="sd">        eos : optional</span>
<span class="sd">            Equation of state. The default is Peng Robinson.</span>
<span class="sd">        phase_ref : str, optional</span>
<span class="sd">            Phase reference. Defaults to the phase at 298.15 K and 101325 Pa.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">pubchem_db</span><span class="o">.</span><span class="n">search_CAS</span><span class="p">(</span><span class="n">CAS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_locked_state</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_names</span><span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">smiles</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">InChI</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">InChI_key</span><span class="p">,</span> 
                         <span class="n">info</span><span class="o">.</span><span class="n">pubchemid</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">iupac_name</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">common_name</span><span class="p">,</span>
                         <span class="n">info</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_groups</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">InChI_key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">CAS</span> <span class="o">==</span> <span class="s1">&#39;56-81-5&#39;</span><span class="p">:</span> <span class="c1"># TODO: Make this part of data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Dortmund</span> <span class="o">=</span> <span class="n">DortmundGroupCounts</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">81</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_data</span><span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(),</span> <span class="n">info</span><span class="o">.</span><span class="n">MW</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_eos</span><span class="p">(</span><span class="n">eos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">)</span>
        <span class="n">has_hydroxyl</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">dct</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dortmund</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNIFAC</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">PSRK</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">81</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">dct</span><span class="p">:</span>
                   <span class="n">has_hydroxyl</span> <span class="o">=</span> <span class="kc">True</span>
                   <span class="k">break</span>
            <span class="k">if</span> <span class="n">has_hydroxyl</span><span class="p">:</span> <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_properties</span><span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MW</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Hfus</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dipole</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">similarity_variable</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">iscyclic_aliphatic</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos</span><span class="p">,</span> <span class="n">has_hydroxyl</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_energies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Hvap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Hfus</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Tm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_1atm</span><span class="p">,</span>
                            <span class="n">phase_ref</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="Chemical.get_key_property_names"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.get_key_property_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_key_property_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the attribute names of key properties required to model a process.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked_state</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_ref</span> <span class="o">!=</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;Cn&#39;</span><span class="p">,</span> <span class="s1">&#39;Psat&#39;</span><span class="p">,</span> <span class="s1">&#39;Tb&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;Cn&#39;</span><span class="p">,)</span></div>
        
<div class="viewcode-block" id="Chemical.get_combustion_reaction"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.get_combustion_reaction">[docs]</a>    <span class="k">def</span> <span class="nf">get_combustion_reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chemicals</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a Reaction object defining the combustion of this chemical.&quot;&quot;&quot;</span>
        <span class="n">ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID</span>
        <span class="n">combustion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combustion</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">combustion</span><span class="p">[</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">tmo</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="n">combustion</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">chemicals</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="Chemical.load_combustion_data"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.load_combustion_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_combustion_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Stoichiometry&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load combustion data (LHV, HHV, and combution attributes)</span>
<span class="sd">        based on the molecular formula and the heat of formation.&quot;&quot;&quot;</span>
        <span class="n">CD</span> <span class="o">=</span> <span class="n">CombustionData</span><span class="o">.</span><span class="n">from_chemical_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">CAS</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">MW</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Hf</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LHV</span> <span class="o">=</span> <span class="n">CD</span><span class="o">.</span><span class="n">LHV</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HHV</span> <span class="o">=</span> <span class="n">CD</span><span class="o">.</span><span class="n">HHV</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combustion</span> <span class="o">=</span> <span class="n">CD</span><span class="o">.</span><span class="n">stoichiometry</span></div>

    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">unpickle_chemical</span><span class="p">,</span> <span class="p">(</span><span class="n">get_chemical_data</span><span class="p">(</span><span class="bp">self</span><span class="p">),)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[str] Identification of chemical.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ID</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">CAS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[str] CAS number of chemical.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CAS</span>
    
<div class="viewcode-block" id="Chemical.get_atoms"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.get_atoms">[docs]</a>    <span class="k">def</span> <span class="nf">get_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;dict[str: int] Atom-count pairs.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">parse_simple_formula</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">)</span></div>

<div class="viewcode-block" id="Chemical.Tsat"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.Tsat">[docs]</a>    <span class="k">def</span> <span class="nf">Tsat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">Tguess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tmax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the saturated temperature (in Kelvin) given the pressure (in Pascal).&quot;&quot;&quot;</span>
        <span class="n">Tb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tb</span>
        <span class="n">Psat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psat</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Tmin</span><span class="p">:</span> <span class="n">Tmin</span> <span class="o">=</span> <span class="n">Psat</span><span class="o">.</span><span class="n">Tmin</span> 
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Tmax</span><span class="p">:</span> <span class="n">Tmax</span> <span class="o">=</span> <span class="n">Psat</span><span class="o">.</span><span class="n">Tmax</span>
        <span class="k">if</span> <span class="n">Tb</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">P</span> <span class="o">==</span> <span class="mi">101325</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Tb</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">Tguess</span><span class="p">:</span>
                <span class="n">Tguess</span> <span class="o">=</span> <span class="n">Tb</span> <span class="o">*</span> <span class="p">(</span><span class="n">P</span> <span class="o">/</span> <span class="mi">101325</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">Tguess</span><span class="p">:</span>
            <span class="n">Tguess</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tmin</span> <span class="o">+</span> <span class="n">Tmax</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">IQ_interpolation</span><span class="p">(</span><span class="n">Psat</span><span class="p">,</span> <span class="n">Tmin</span><span class="p">,</span> <span class="n">Tmax</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Psat</span><span class="p">(</span><span class="n">Tmax</span><span class="o">-</span><span class="mf">1e-4</span><span class="p">),</span> <span class="n">Tguess</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Chemical.copy"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">CAS</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a copy of the chemical with a new ID.&quot;&quot;&quot;</span>
        <span class="n">cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span>
        <span class="n">CAS</span> <span class="o">=</span> <span class="n">CAS</span> <span class="ow">or</span> <span class="n">ID</span>
        <span class="n">new</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
        <span class="n">getfield</span> <span class="o">=</span> <span class="nb">getattr</span>
        <span class="n">setfield</span> <span class="o">=</span> <span class="nb">setattr</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">:</span> 
            <span class="n">value</span> <span class="o">=</span> <span class="n">getfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
            <span class="n">setfield</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">copy_maybe</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="n">new</span><span class="o">.</span><span class="n">_ID</span> <span class="o">=</span> <span class="n">ID</span>
        <span class="n">new</span><span class="o">.</span><span class="n">_CAS</span> <span class="o">=</span> <span class="n">CAS</span>
        <span class="n">new</span><span class="o">.</span><span class="n">_locked_state</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">_locked_state</span>
        <span class="n">new</span><span class="o">.</span><span class="n">_init_energies</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">Cn</span><span class="p">,</span> <span class="n">new</span><span class="o">.</span><span class="n">Hvap</span><span class="p">,</span> <span class="n">new</span><span class="o">.</span><span class="n">Psat</span><span class="p">,</span> <span class="n">new</span><span class="o">.</span><span class="n">Hfus</span><span class="p">,</span> <span class="n">new</span><span class="o">.</span><span class="n">Tm</span><span class="p">,</span>
                           <span class="n">new</span><span class="o">.</span><span class="n">Tb</span><span class="p">,</span> <span class="n">new</span><span class="o">.</span><span class="n">eos</span><span class="p">,</span> <span class="n">new</span><span class="o">.</span><span class="n">eos_1atm</span><span class="p">,</span> <span class="n">new</span><span class="o">.</span><span class="n">phase_ref</span><span class="p">,</span>
                           <span class="n">new</span><span class="o">.</span><span class="n">_locked_state</span><span class="p">)</span>
        <span class="n">cache</span><span class="p">[</span><span class="n">CAS</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span>
        <span class="k">return</span> <span class="n">new</span></div>
    <span class="n">__copy__</span> <span class="o">=</span> <span class="n">copy</span>
    
    <span class="k">def</span> <span class="nf">_init_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CAS</span><span class="p">,</span> <span class="n">smiles</span><span class="p">,</span> <span class="n">InChI</span><span class="p">,</span> <span class="n">InChI_key</span><span class="p">,</span>
                    <span class="n">pubchemid</span><span class="p">,</span> <span class="n">iupac_name</span><span class="p">,</span> <span class="n">common_name</span><span class="p">,</span> <span class="n">formula</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_CAS</span> <span class="o">=</span> <span class="n">CAS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smiles</span> <span class="o">=</span> <span class="n">smiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InChI</span> <span class="o">=</span> <span class="n">InChI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InChI_key</span> <span class="o">=</span> <span class="n">InChI_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pubchemid</span> <span class="o">=</span> <span class="n">pubchemid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iupac_name</span> <span class="o">=</span> <span class="n">iupac_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">common_name</span> <span class="o">=</span> <span class="n">common_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formula</span> <span class="o">=</span> <span class="n">formula</span>
        
    <span class="k">def</span> <span class="nf">_init_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">InChI_key</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">InChI_key</span> <span class="ow">in</span> <span class="n">DDBST_UNIFAC_assignments</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">UNIFAC</span> <span class="o">=</span> <span class="n">DDBST_UNIFAC_assignments</span><span class="p">[</span><span class="n">InChI_key</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">UNIFAC</span> <span class="o">=</span> <span class="n">UNIFACGroupCounts</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">InChI_key</span> <span class="ow">in</span> <span class="n">DDBST_MODIFIED_UNIFAC_assignments</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Dortmund</span> <span class="o">=</span> <span class="n">DDBST_MODIFIED_UNIFAC_assignments</span><span class="p">[</span><span class="n">InChI_key</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Dortmund</span> <span class="o">=</span> <span class="n">DortmundGroupCounts</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">InChI_key</span> <span class="ow">in</span> <span class="n">DDBST_PSRK_assignments</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PSRK</span> <span class="o">=</span> <span class="n">DDBST_PSRK_assignments</span><span class="p">[</span><span class="n">InChI_key</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PSRK</span> <span class="o">=</span> <span class="n">PSRKGroupCounts</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_init_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CAS</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">MW</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MW</span> <span class="o">=</span> <span class="n">MW</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tm</span> <span class="o">=</span> <span class="n">Tm</span><span class="p">(</span><span class="n">CAS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tb</span> <span class="o">=</span> <span class="n">Tb</span><span class="p">(</span><span class="n">CAS</span><span class="p">)</span>

        <span class="c1"># Critical Point</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">=</span> <span class="n">Tc</span><span class="p">(</span><span class="n">CAS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span> <span class="o">=</span> <span class="n">Pc</span><span class="p">(</span><span class="n">CAS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span> <span class="o">=</span> <span class="n">Vc</span><span class="p">(</span><span class="n">CAS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">omega</span><span class="p">(</span><span class="n">CAS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Zc</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">Z</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span><span class="p">)</span> <span class="k">if</span> <span class="nb">all</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span><span class="p">))</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># Triple point</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pt</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="n">CAS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tt</span> <span class="o">=</span> <span class="n">Tt</span><span class="p">(</span><span class="n">CAS</span><span class="p">)</span>

        <span class="c1"># Energy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Hfus</span> <span class="o">=</span> <span class="n">Hfus</span><span class="p">(</span><span class="n">CASRN</span><span class="o">=</span><span class="n">CAS</span><span class="p">,</span> <span class="n">MW</span><span class="o">=</span><span class="n">MW</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Hsub</span> <span class="o">=</span> <span class="n">Hsub</span><span class="p">(</span><span class="n">CASRN</span><span class="o">=</span><span class="n">CAS</span><span class="p">)</span>

        <span class="c1"># Chemistry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Hf</span> <span class="o">=</span> <span class="n">Hf</span><span class="p">(</span><span class="n">CAS</span><span class="p">)</span> <span class="ow">or</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">CD</span> <span class="o">=</span> <span class="n">CombustionData</span><span class="o">.</span><span class="n">from_chemical_data</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CAS</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Hf</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LHV</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HHV</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combustion</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LHV</span> <span class="o">=</span> <span class="n">CD</span><span class="o">.</span><span class="n">LHV</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HHV</span> <span class="o">=</span> <span class="n">CD</span><span class="o">.</span><span class="n">HHV</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combustion</span> <span class="o">=</span> <span class="n">CD</span><span class="o">.</span><span class="n">stoichiometry</span>
        
        <span class="c1"># Critical Point</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">StielPolar</span> <span class="o">=</span> <span class="n">StielPolar</span><span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
        
        <span class="c1"># Other</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dipole</span> <span class="o">=</span> <span class="n">dipole</span><span class="p">(</span><span class="n">CAS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">similarity_variable</span> <span class="o">=</span> <span class="n">compute_similarity_variable</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">MW</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iscyclic_aliphatic</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_init_eos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eos</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eos</span> <span class="o">=</span> <span class="n">create_eos</span><span class="p">(</span><span class="n">eos</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eos_1atm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos</span><span class="o">.</span><span class="n">to_TP</span><span class="p">(</span><span class="mf">298.15</span><span class="p">,</span> <span class="mi">101325</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_init_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CAS</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">Zc</span><span class="p">,</span> <span class="n">Vc</span><span class="p">,</span> <span class="n">Hfus</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span>
                         <span class="n">dipole</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">iscyclic_aliphatic</span><span class="p">,</span> <span class="n">eos</span><span class="p">,</span>
                         <span class="n">has_hydroxyl</span><span class="p">):</span>
        <span class="c1"># Vapor pressure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Psat</span> <span class="o">=</span> <span class="n">Psat</span> <span class="o">=</span> <span class="n">VaporPressure</span><span class="p">((</span><span class="n">CAS</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">))</span>
        
        <span class="c1"># Volume</span>
        <span class="n">sdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">CAS</span><span class="p">,)</span>
        <span class="n">ldata</span> <span class="o">=</span> <span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">Vc</span><span class="p">,</span> <span class="n">Zc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">Psat</span><span class="p">,</span> <span class="n">eos</span><span class="p">,</span> <span class="n">dipole</span><span class="p">,</span> <span class="n">has_hydroxyl</span><span class="p">)</span>
        <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">eos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span> <span class="o">=</span> <span class="n">Volume</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">gdata</span><span class="p">)</span>
        
        <span class="c1"># Heat capacity</span>
        <span class="n">Cn</span> <span class="o">=</span> <span class="n">PhaseTProperty</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s1">&#39;Cn&#39;</span><span class="p">)</span>
        <span class="n">sdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">MW</span><span class="p">)</span>
        <span class="n">ldata</span> <span class="o">=</span> <span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">Cn</span><span class="p">)</span>
        <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">iscyclic_aliphatic</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cn</span> <span class="o">=</span> <span class="n">Cn</span> <span class="o">=</span> <span class="n">HeatCapacity</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">gdata</span><span class="p">,</span> <span class="n">Cn</span><span class="p">)</span>
        
        <span class="c1"># Heat of vaporization</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">similarity_variable</span><span class="p">,</span> <span class="n">Psat</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Hvap</span> <span class="o">=</span> <span class="n">Hvap</span> <span class="o">=</span> <span class="n">EnthalpyVaporization</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="c1"># Viscosity</span>
        <span class="n">ldata</span> <span class="o">=</span> <span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">Vc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">Psat</span><span class="p">,</span> <span class="n">V</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
        <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">Zc</span><span class="p">,</span> <span class="n">dipole</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">=</span> <span class="n">Viscosity</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">gdata</span><span class="p">)</span>
        
        <span class="c1"># Conductivity</span>
        <span class="n">ldata</span> <span class="o">=</span> <span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">Hfus</span><span class="p">)</span>
        <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">Vc</span><span class="p">,</span> <span class="n">Zc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">dipole</span><span class="p">,</span> <span class="n">V</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="n">Cn</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="n">mu</span><span class="o">.</span><span class="n">g</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span> <span class="o">=</span> <span class="n">ThermalConductivity</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">gdata</span><span class="p">)</span>
        
        <span class="c1"># Surface tension</span>
        <span class="k">if</span> <span class="n">Tb</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>    <span class="n">Hvap_Tb</span> <span class="o">=</span> <span class="n">Hvap</span><span class="p">(</span><span class="n">Tb</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span> <span class="n">Hvap_Tb</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">try</span><span class="p">:</span>    <span class="n">Cnl_Tb</span> <span class="o">=</span> <span class="n">Cn</span><span class="o">.</span><span class="n">l</span><span class="p">(</span><span class="n">Tb</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span> <span class="n">Cnl_Tb</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">try</span><span class="p">:</span>    <span class="n">rhol</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">V</span><span class="o">.</span><span class="n">l</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="mf">101325.</span><span class="p">)</span> <span class="o">*</span> <span class="n">MW</span>
            <span class="k">except</span><span class="p">:</span> <span class="n">rhol</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Hvap_Tb</span> <span class="o">=</span> <span class="n">Cnl_Tb</span> <span class="o">=</span> <span class="n">rhol</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">Vc</span><span class="p">,</span> <span class="n">Zc</span><span class="p">,</span>
                <span class="n">omega</span><span class="p">,</span> <span class="n">StielPolar</span><span class="p">,</span> <span class="n">Hvap_Tb</span><span class="p">,</span> <span class="n">rhol</span><span class="p">,</span> <span class="n">Cnl_Tb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">SurfaceTension</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="c1"># Other</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">Permittivity</span><span class="p">((</span><span class="n">CAS</span><span class="p">,</span> <span class="n">V</span><span class="o">.</span><span class="n">l</span><span class="p">,))</span>
        <span class="c1"># self.delta = SolubilityParameter(self)</span>
        <span class="c1"># self.molecular_diameter = MolecularDiameter(self)</span>

    <span class="k">def</span> <span class="nf">_init_energies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Cn</span><span class="p">,</span> <span class="n">Hvap</span><span class="p">,</span> <span class="n">Psat</span><span class="p">,</span> <span class="n">Hfus</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">eos</span><span class="p">,</span> <span class="n">eos_1atm</span><span class="p">,</span>
                       <span class="n">phase_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">single_phase</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>        
        <span class="c1"># Reference</span>
        <span class="n">P_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P_ref</span>
        <span class="n">T_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T_ref</span>
        <span class="n">H_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">H_ref</span>
        <span class="n">S_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_ref</span>
        <span class="n">Sfus</span> <span class="o">=</span> <span class="n">Hfus</span> <span class="o">/</span> <span class="n">Tm</span> <span class="k">if</span> <span class="n">Hfus</span> <span class="ow">and</span> <span class="n">Tm</span> <span class="k">else</span> <span class="kc">None</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Cn</span><span class="p">,</span> <span class="n">PhaseProperty</span><span class="p">):</span>
            <span class="n">Cn_s</span> <span class="o">=</span> <span class="n">Cn</span><span class="o">.</span><span class="n">s</span>
            <span class="n">Cn_l</span> <span class="o">=</span> <span class="n">Cn</span><span class="o">.</span><span class="n">l</span>
            <span class="n">Cn_g</span> <span class="o">=</span> <span class="n">Cn</span><span class="o">.</span><span class="n">g</span>
            <span class="n">has_Cns</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">Cn_s</span><span class="p">)</span>
            <span class="n">has_Cnl</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">Cn_l</span><span class="p">)</span>
            <span class="n">has_Cng</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">Cn_g</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">Cn</span> <span class="ow">and</span> <span class="n">single_phase</span><span class="p">:</span>
            <span class="n">has_Cns</span> <span class="o">=</span> <span class="n">single_phase</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span>
            <span class="n">has_Cnl</span> <span class="o">=</span> <span class="n">single_phase</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span>
            <span class="n">has_Cng</span> <span class="o">=</span> <span class="n">single_phase</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span>
            <span class="n">Cn_s</span> <span class="o">=</span> <span class="n">Cn_l</span> <span class="o">=</span> <span class="n">Cn_g</span> <span class="o">=</span> <span class="n">Cn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">has_Cns</span> <span class="o">=</span> <span class="n">has_Cnl</span> <span class="o">=</span> <span class="n">has_Cng</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="n">has_Cns</span><span class="p">,</span> <span class="n">has_Cnl</span><span class="p">,</span> <span class="n">has_Cng</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">phase_ref</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">phase_ref</span> <span class="o">=</span> <span class="n">phase_ref</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Tm</span> <span class="ow">and</span> <span class="n">T_ref</span> <span class="o">&lt;=</span> <span class="n">Tm</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phase_ref</span> <span class="o">=</span> <span class="n">phase_ref</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span>
                <span class="k">elif</span> <span class="n">Tb</span> <span class="ow">and</span> <span class="n">T_ref</span> <span class="o">&gt;=</span> <span class="n">Tb</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phase_ref</span> <span class="o">=</span> <span class="n">phase_ref</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phase_ref</span> <span class="o">=</span> <span class="n">phase_ref</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span>

            <span class="k">if</span> <span class="n">Hvap</span><span class="p">:</span>
                <span class="n">Hvap_Tb</span> <span class="o">=</span> <span class="n">Hvap</span><span class="p">(</span><span class="n">Tb</span><span class="p">)</span> <span class="k">if</span> <span class="n">Tb</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="n">Svap_Tb</span> <span class="o">=</span> <span class="n">Hvap_Tb</span> <span class="o">/</span> <span class="n">Tb</span> <span class="k">if</span> <span class="n">Tb</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Hvap_Tb</span> <span class="o">=</span> <span class="n">Svap_Tb</span> <span class="o">=</span> <span class="kc">None</span>
            
            <span class="c1"># Enthalpy and entropy integrals</span>
            <span class="k">if</span> <span class="n">phase_ref</span> <span class="o">!=</span> <span class="s1">&#39;l&#39;</span> <span class="ow">and</span> <span class="n">has_Cnl</span> <span class="ow">and</span> <span class="p">(</span><span class="n">Tm</span> <span class="ow">and</span> <span class="n">Tb</span><span class="p">):</span>
                <span class="n">H_int_Tm_to_Tb_l</span> <span class="o">=</span> <span class="n">Cn_l</span><span class="o">.</span><span class="n">integrate_by_T</span><span class="p">(</span><span class="n">Tm</span><span class="p">,</span> <span class="n">Tb</span><span class="p">)</span>
                <span class="n">S_int_Tm_to_Tb_l</span> <span class="o">=</span> <span class="n">Cn_l</span><span class="o">.</span><span class="n">integrate_by_T_over_T</span><span class="p">(</span><span class="n">Tm</span><span class="p">,</span> <span class="n">Tb</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">H_int_Tm_to_Tb_l</span> <span class="o">=</span> <span class="n">S_int_Tm_to_Tb_l</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">phase_ref</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span> <span class="ow">and</span> <span class="n">has_Cns</span> <span class="ow">and</span> <span class="n">Tm</span><span class="p">:</span>
                <span class="n">H_int_T_ref_to_Tm_s</span> <span class="o">=</span> <span class="n">Cn_s</span><span class="o">.</span><span class="n">integrate_by_T</span><span class="p">(</span><span class="n">T_ref</span><span class="p">,</span> <span class="n">Tm</span><span class="p">)</span>
                <span class="n">S_int_T_ref_to_Tm_s</span> <span class="o">=</span> <span class="n">Cn_s</span><span class="o">.</span><span class="n">integrate_by_T_over_T</span><span class="p">(</span><span class="n">T_ref</span><span class="p">,</span> <span class="n">Tm</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">H_int_T_ref_to_Tm_s</span> <span class="o">=</span> <span class="n">S_int_T_ref_to_Tm_s</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">phase_ref</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span> <span class="ow">and</span> <span class="n">has_Cng</span> <span class="ow">and</span> <span class="n">Tb</span><span class="p">:</span>
                <span class="n">H_int_Tb_to_T_ref_g</span> <span class="o">=</span> <span class="n">Cn_g</span><span class="o">.</span><span class="n">integrate_by_T</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">T_ref</span><span class="p">)</span>
                <span class="n">S_int_Tb_to_T_ref_g</span> <span class="o">=</span> <span class="n">Cn_g</span><span class="o">.</span><span class="n">integrate_by_T_over_T</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">T_ref</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">H_int_Tb_to_T_ref_g</span> <span class="o">=</span> <span class="n">S_int_Tb_to_T_ref_g</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">phase_ref</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">has_Cnl</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">Tb</span><span class="p">:</span>
                        <span class="n">H_int_T_ref_to_Tb_l</span> <span class="o">=</span> <span class="n">Cn_l</span><span class="o">.</span><span class="n">integrate_by_T</span><span class="p">(</span><span class="n">T_ref</span><span class="p">,</span> <span class="n">Tb</span><span class="p">)</span>
                        <span class="n">S_int_T_ref_to_Tb_l</span> <span class="o">=</span> <span class="n">Cn_l</span><span class="o">.</span><span class="n">integrate_by_T_over_T</span><span class="p">(</span><span class="n">T_ref</span><span class="p">,</span> <span class="n">Tb</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">H_int_T_ref_to_Tb_l</span> <span class="o">=</span> <span class="n">S_int_T_ref_to_Tb_l</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="n">Tm</span><span class="p">:</span>
                        <span class="n">H_int_Tm_to_T_ref_l</span> <span class="o">=</span> <span class="n">Cn_l</span><span class="o">.</span><span class="n">integrate_by_T</span><span class="p">(</span><span class="n">Tm</span><span class="p">,</span> <span class="n">T_ref</span><span class="p">)</span>
                        <span class="n">S_int_Tm_to_T_ref_l</span> <span class="o">=</span> <span class="n">Cn_l</span><span class="o">.</span><span class="n">integrate_by_T_over_T</span><span class="p">(</span><span class="n">Tm</span><span class="p">,</span> <span class="n">T_ref</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">H_int_Tm_to_T_ref_l</span> <span class="o">=</span> <span class="n">S_int_Tm_to_T_ref_l</span> <span class="o">=</span> <span class="kc">None</span>
    
            <span class="c1"># Excess data</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eos</span><span class="p">,</span> <span class="n">GCEOS_DUMMY</span><span class="p">):</span>
                <span class="n">H_dep_ref_g</span> <span class="o">=</span> <span class="n">S_dep_ref_g</span> <span class="o">=</span> <span class="n">H_dep_ref_l</span> <span class="o">=</span> <span class="n">S_dep_ref_l</span> <span class="o">=</span> \
                <span class="n">H_dep_T_ref_Pb</span> <span class="o">=</span> <span class="n">S_dep_T_ref_Pb</span> <span class="o">=</span> <span class="n">H_dep_Tb_Pb_g</span> <span class="o">=</span> <span class="n">H_dep_Tb_P_ref_g</span> <span class="o">=</span> \
                <span class="n">S_dep_Tb_P_ref_g</span> <span class="o">=</span> <span class="n">S_dep_Tb_Pb_g</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">phase_ref</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>
                    <span class="n">eos_phase_ref</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">to_TP</span><span class="p">(</span><span class="n">T_ref</span><span class="p">,</span> <span class="n">P_ref</span><span class="p">)</span>
                    <span class="n">H_dep_ref_g</span> <span class="o">=</span> <span class="n">eos_phase_ref</span><span class="o">.</span><span class="n">H_dep_g</span>
                    <span class="n">S_dep_ref_g</span> <span class="o">=</span> <span class="n">eos_phase_ref</span><span class="o">.</span><span class="n">S_dep_g</span>
                <span class="k">elif</span> <span class="n">phase_ref</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span>
                    <span class="n">eos_phase_ref</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">to_TP</span><span class="p">(</span><span class="n">T_ref</span><span class="p">,</span> <span class="n">P_ref</span><span class="p">)</span>
                    <span class="n">H_dep_ref_l</span> <span class="o">=</span> <span class="n">eos_phase_ref</span><span class="o">.</span><span class="n">H_dep_l</span>
                    <span class="n">S_dep_ref_l</span> <span class="o">=</span> <span class="n">eos_phase_ref</span><span class="o">.</span><span class="n">S_dep_l</span>
                    <span class="n">eos_T_ref_Pb</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">to_TP</span><span class="p">(</span><span class="n">T_ref</span><span class="p">,</span> <span class="mi">101325</span><span class="p">)</span>
                    <span class="n">H_dep_T_ref_Pb</span> <span class="o">=</span> <span class="n">eos_T_ref_Pb</span><span class="o">.</span><span class="n">H_dep_l</span>
                    <span class="n">S_dep_T_ref_Pb</span> <span class="o">=</span> <span class="n">eos_T_ref_Pb</span><span class="o">.</span><span class="n">S_dep_l</span>
                <span class="k">if</span> <span class="n">Tb</span><span class="p">:</span>
                    <span class="n">eos_Tb</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">to_TP</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="mi">101325</span><span class="p">)</span>
                    <span class="n">eos_Tb_P_ref</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">to_TP</span><span class="p">(</span><span class="n">Tb</span><span class="p">,</span> <span class="n">P_ref</span><span class="p">)</span>
                    <span class="n">H_dep_Tb_Pb_g</span> <span class="o">=</span> <span class="n">eos_Tb</span><span class="o">.</span><span class="n">H_dep_g</span>
                    <span class="n">H_dep_Tb_P_ref_g</span> <span class="o">=</span> <span class="n">eos_Tb_P_ref</span><span class="o">.</span><span class="n">H_dep_g</span>
                    <span class="n">S_dep_Tb_P_ref_g</span> <span class="o">=</span> <span class="n">eos_Tb_P_ref</span><span class="o">.</span><span class="n">S_dep_g</span>
                    <span class="n">S_dep_Tb_Pb_g</span> <span class="o">=</span> <span class="n">eos_Tb</span><span class="o">.</span><span class="n">S_dep_g</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">S_dep_Tb_Pb_g</span> <span class="o">=</span> <span class="n">S_dep_Tb_P_ref_g</span> <span class="o">=</span> <span class="n">H_dep_Tb_P_ref_g</span> <span class="o">=</span> \
                    <span class="n">H_dep_Tb_Pb_g</span> <span class="o">=</span> <span class="mf">0.</span>
            
            <span class="c1"># Enthalpy and Entropy</span>
            <span class="k">if</span> <span class="n">phase_ref</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span>
                <span class="n">sdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_s</span><span class="p">,</span> <span class="n">T_ref</span><span class="p">,</span> <span class="n">H_ref</span><span class="p">)</span>
                <span class="n">ldata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_l</span><span class="p">,</span> <span class="n">H_int_T_ref_to_Tm_s</span><span class="p">,</span> <span class="n">Hfus</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">H_ref</span><span class="p">)</span>
                <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_g</span><span class="p">,</span> <span class="n">H_int_T_ref_to_Tm_s</span><span class="p">,</span> <span class="n">Hfus</span><span class="p">,</span> <span class="n">H_int_Tm_to_Tb_l</span><span class="p">,</span> <span class="n">Hvap_Tb</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">H_ref</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">EnthalpyRefSolid</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">gdata</span><span class="p">)</span>
                <span class="n">sdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_s</span><span class="p">,</span> <span class="n">T_ref</span><span class="p">,</span> <span class="n">S_ref</span><span class="p">)</span>
                <span class="n">ldata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_l</span><span class="p">,</span> <span class="n">S_int_T_ref_to_Tm_s</span><span class="p">,</span> <span class="n">Sfus</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">S_ref</span><span class="p">)</span>
                <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_g</span><span class="p">,</span> <span class="n">S_int_T_ref_to_Tm_s</span><span class="p">,</span> <span class="n">Sfus</span><span class="p">,</span> <span class="n">S_int_Tm_to_Tb_l</span><span class="p">,</span> <span class="n">Svap_Tb</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">P_ref</span><span class="p">,</span> <span class="n">S_ref</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="n">EntropyRefSolid</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">gdata</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">phase_ref</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span>
                <span class="n">sdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_s</span><span class="p">,</span> <span class="n">H_int_Tm_to_T_ref_l</span><span class="p">,</span> <span class="n">Hfus</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">H_ref</span><span class="p">)</span>
                <span class="n">ldata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_l</span><span class="p">,</span> <span class="n">T_ref</span><span class="p">,</span> <span class="n">H_ref</span><span class="p">)</span>
                <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_g</span><span class="p">,</span> <span class="n">H_int_T_ref_to_Tb_l</span><span class="p">,</span> <span class="n">Hvap_Tb</span><span class="p">,</span> <span class="n">T_ref</span><span class="p">,</span> <span class="n">H_ref</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">EnthalpyRefLiquid</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">gdata</span><span class="p">)</span>
                <span class="n">sdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_s</span><span class="p">,</span> <span class="n">S_int_Tm_to_T_ref_l</span><span class="p">,</span> <span class="n">Sfus</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">S_ref</span><span class="p">)</span>
                <span class="n">ldata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_l</span><span class="p">,</span> <span class="n">T_ref</span><span class="p">,</span> <span class="n">S_ref</span><span class="p">)</span>
                <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_g</span><span class="p">,</span> <span class="n">S_int_T_ref_to_Tb_l</span><span class="p">,</span> <span class="n">Svap_Tb</span><span class="p">,</span> <span class="n">T_ref</span><span class="p">,</span> <span class="n">P_ref</span><span class="p">,</span> <span class="n">S_ref</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="n">EntropyRefLiquid</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">gdata</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">phase_ref</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>
                <span class="n">sdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_s</span><span class="p">,</span> <span class="n">H_int_Tb_to_T_ref_g</span><span class="p">,</span> <span class="n">Hvap_Tb</span><span class="p">,</span> <span class="n">H_int_Tm_to_Tb_l</span><span class="p">,</span> <span class="n">Hfus</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">H_ref</span><span class="p">)</span>
                <span class="n">ldata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_l</span><span class="p">,</span> <span class="n">H_int_Tb_to_T_ref_g</span><span class="p">,</span> <span class="n">Hvap_Tb</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">H_ref</span><span class="p">)</span>
                <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_g</span><span class="p">,</span> <span class="n">T_ref</span><span class="p">,</span> <span class="n">H_ref</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">EnthalpyRefGas</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">gdata</span><span class="p">)</span>
                <span class="n">sdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_s</span><span class="p">,</span> <span class="n">S_int_Tb_to_T_ref_g</span><span class="p">,</span> <span class="n">Svap_Tb</span><span class="p">,</span> <span class="n">S_int_Tm_to_Tb_l</span><span class="p">,</span> <span class="n">Sfus</span><span class="p">,</span> <span class="n">Tm</span><span class="p">,</span> <span class="n">S_ref</span><span class="p">)</span>
                <span class="n">ldata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_l</span><span class="p">,</span> <span class="n">S_int_Tb_to_T_ref_g</span><span class="p">,</span> <span class="n">Svap_Tb</span><span class="p">,</span> <span class="n">Tb</span><span class="p">,</span> <span class="n">S_ref</span><span class="p">)</span>
                <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cn_g</span><span class="p">,</span> <span class="n">T_ref</span><span class="p">,</span> <span class="n">P_ref</span><span class="p">,</span> <span class="n">S_ref</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="n">EntropyRefGas</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">gdata</span><span class="p">)</span>
            
            <span class="c1"># Excess energies</span>
            <span class="k">if</span> <span class="n">phase_ref</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">H_excess</span> <span class="o">=</span> <span class="n">ExcessEnthalpyRefSolid</span><span class="p">((),</span> <span class="p">(),</span> <span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">S_excess</span> <span class="o">=</span> <span class="n">ExcessEntropyRefSolid</span><span class="p">((),</span> <span class="p">(),</span> <span class="p">())</span>
            <span class="k">elif</span> <span class="n">phase_ref</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span>
                <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">eos</span><span class="p">,</span> <span class="n">H_dep_T_ref_Pb</span><span class="p">,</span> <span class="n">H_dep_ref_l</span><span class="p">,</span> <span class="n">H_dep_Tb_Pb_g</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">H_excess</span> <span class="o">=</span> <span class="n">ExcessEnthalpyRefLiquid</span><span class="p">((),</span> <span class="p">(),</span> <span class="n">gdata</span><span class="p">)</span>
                <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">eos</span><span class="p">,</span> <span class="n">S_dep_T_ref_Pb</span><span class="p">,</span> <span class="n">S_dep_ref_l</span><span class="p">,</span> <span class="n">S_dep_Tb_Pb_g</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">S_excess</span> <span class="o">=</span> <span class="n">ExcessEntropyRefLiquid</span><span class="p">((),</span> <span class="p">(),</span> <span class="n">gdata</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">phase_ref</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>
                <span class="n">ldata</span> <span class="o">=</span> <span class="p">(</span><span class="n">eos</span><span class="p">,</span> <span class="n">H_dep_Tb_Pb_g</span><span class="p">,</span> <span class="n">H_dep_Tb_P_ref_g</span><span class="p">,</span> <span class="n">eos_1atm</span><span class="p">)</span>
                <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">eos</span><span class="p">,</span> <span class="n">H_dep_ref_g</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">H_excess</span> <span class="o">=</span> <span class="n">ExcessEnthalpyRefGas</span><span class="p">((),</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">gdata</span><span class="p">)</span>
                <span class="n">ldata</span> <span class="o">=</span> <span class="p">(</span><span class="n">eos</span><span class="p">,</span> <span class="n">S_dep_Tb_Pb_g</span><span class="p">,</span> <span class="n">S_dep_Tb_P_ref_g</span><span class="p">,</span> <span class="n">eos_1atm</span><span class="p">)</span>
                <span class="n">gdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">eos</span><span class="p">,</span> <span class="n">S_dep_ref_g</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">S_excess</span> <span class="o">=</span> <span class="n">ExcessEntropyRefGas</span><span class="p">((),</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">gdata</span><span class="p">)</span>
                
            <span class="k">if</span> <span class="n">single_phase</span><span class="p">:</span>
                <span class="n">getfield</span> <span class="o">=</span> <span class="nb">getattr</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">getfield</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="n">single_phase</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="n">getfield</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">single_phase</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">H_excess</span> <span class="o">=</span> <span class="n">getfield</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H_excess</span><span class="p">,</span> <span class="n">single_phase</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">S_excess</span> <span class="o">=</span> <span class="n">getfield</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S_excess</span><span class="p">,</span> <span class="n">single_phase</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_excess</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">H_excess</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="Chemical.default"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.default">[docs]</a>    <span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default all `slots` with the chemical properties of water. If no</span>
<span class="sd">        `slots` given, all essential chemical properties that are missing</span>
<span class="sd">        are defaulted. `slots` which are still missing are returned as set.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        slots : Iterable[str], optional</span>
<span class="sd">            Names of chemical properties to default.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        missing_slots : list[str]</span>
<span class="sd">            Names of chemical properties that are still missing.</span>
<span class="sd">        </span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from thermosteam import Chemical</span>
<span class="sd">        &gt;&gt;&gt; Substance = Chemical.blank(&#39;Substance&#39;)</span>
<span class="sd">        &gt;&gt;&gt; missing_slots = Substance.default()</span>
<span class="sd">        &gt;&gt;&gt; sorted(missing_slots)</span>
<span class="sd">        [&#39;Dortmund&#39;, &#39;Hfus&#39;, &#39;Hsub&#39;, &#39;Hvap&#39;, &#39;InChI&#39;, &#39;InChI_key&#39;, &#39;PSRK&#39;, &#39;Pc&#39;, &#39;Psat&#39;, &#39;Pt&#39;, &#39;StielPolar&#39;, &#39;Tb&#39;, &#39;Tc&#39;, &#39;Tm&#39;, &#39;Tt&#39;, &#39;UNIFAC&#39;, &#39;V&#39;, &#39;Vc&#39;, &#39;Zc&#39;, &#39;combustion&#39;, &#39;common_name&#39;, &#39;dipole&#39;, &#39;eos&#39;, &#39;eos_1atm&#39;, &#39;formula&#39;, &#39;iscyclic_aliphatic&#39;, &#39;iupac_name&#39;, &#39;omega&#39;, &#39;pubchemid&#39;, &#39;similarity_variable&#39;, &#39;smiles&#39;]</span>
<span class="sd">        </span>
<span class="sd">        Note that missing slots does not include essential properties volume, heat capacity, and conductivity.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">slots</span><span class="p">:</span>
            <span class="n">slots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_missing_slots</span><span class="p">(</span><span class="n">slots</span><span class="p">)</span>   
        <span class="n">hasfield</span> <span class="o">=</span> <span class="nb">hasattr</span>
        <span class="c1"># Default to Water property values</span>
        <span class="k">if</span> <span class="s1">&#39;MW&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MW</span> <span class="o">=</span> <span class="n">MW</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">MW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MW</span>
        <span class="k">if</span> <span class="s1">&#39;sigma&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="mf">0.072055</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mu&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
            <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span>
            <span class="k">if</span> <span class="n">hasfield</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">):</span>
                <span class="n">mu</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="mf">0.00091272</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">mu</span><span class="p">:</span>
                <span class="n">mu</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="mf">0.00091272</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;V&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
            <span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span>
            <span class="n">V_default</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">rho_to_V</span><span class="p">(</span><span class="mi">1050</span><span class="p">,</span> <span class="n">MW</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">hasfield</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">):</span>
                <span class="n">V</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">V_default</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">V</span><span class="p">:</span>
                <span class="n">V</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">V_default</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;kappa&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
            <span class="n">kappa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span>
            <span class="k">if</span> <span class="n">hasfield</span><span class="p">(</span><span class="n">kappa</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">):</span>
                <span class="n">kappa</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="mf">0.5942</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">kappa</span><span class="p">:</span>
                <span class="n">kappa</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="mf">0.5942</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">i</span> <span class="ow">in</span> <span class="n">slots</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;HHV&#39;</span><span class="p">,</span> <span class="s1">&#39;LHV&#39;</span><span class="p">,</span> <span class="s1">&#39;combustion&#39;</span><span class="p">,</span> <span class="s1">&#39;Hf&#39;</span><span class="p">)]):</span>
                <span class="k">if</span> <span class="s1">&#39;Hf&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Dulong&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;Stoichiometry&#39;</span>
                <span class="n">CD</span> <span class="o">=</span> <span class="n">CombustionData</span><span class="o">.</span><span class="n">from_chemical_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">CAS</span><span class="p">,</span>
                                                       <span class="n">MW</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Hf</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;Hf&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Hf</span> <span class="o">=</span> <span class="n">CD</span><span class="o">.</span><span class="n">Hf</span>
                <span class="k">if</span> <span class="s1">&#39;HHV&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HHV</span> <span class="o">=</span> <span class="n">CD</span><span class="o">.</span><span class="n">HHV</span>
                <span class="k">if</span> <span class="s1">&#39;LHV&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LHV</span> <span class="o">=</span> <span class="n">CD</span><span class="o">.</span><span class="n">LHV</span>
                <span class="k">if</span> <span class="s1">&#39;combustion&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">combustion</span> <span class="o">=</span> <span class="n">CD</span><span class="o">.</span><span class="n">stoichiometry</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;LHV&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LHV</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="s1">&#39;HHV&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">HHV</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="s1">&#39;combustion&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combustion</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;Hf&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Hf</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="s1">&#39;epsilon&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;phase_ref&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phase_ref</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;eos&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eos</span> <span class="o">=</span> <span class="n">GCEOS_DUMMY</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="mf">101325.</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eos_1atm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos</span><span class="o">.</span><span class="n">to_TP</span><span class="p">(</span><span class="mf">298.15</span><span class="p">,</span> <span class="mi">101325</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Cn&#39;</span> <span class="ow">in</span> <span class="n">slots</span><span class="p">:</span>
            <span class="n">MW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MW</span>
            <span class="n">Cn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cn</span>
            <span class="n">phase_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_ref</span>
            <span class="n">getfield</span> <span class="o">=</span> <span class="nb">getattr</span>
            <span class="n">single_phase</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Cn</span><span class="p">,</span> <span class="n">TDependentModelHandle</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">single_phase</span><span class="p">:</span>
                <span class="n">Cn</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="mf">4.18</span><span class="o">*</span><span class="n">MW</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s1">&#39;Cn&#39;</span><span class="p">)</span>
                <span class="n">Cn_phase</span> <span class="o">=</span> <span class="n">Cn</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Cn_phase</span> <span class="o">=</span> <span class="n">getfield</span><span class="p">(</span><span class="n">Cn</span><span class="p">,</span> <span class="n">phase_ref</span><span class="p">)</span>
                <span class="n">Cn_phase</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="mf">4.18</span><span class="o">*</span><span class="n">MW</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s1">&#39;Cn&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_free_energies</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_free_energies</span><span class="p">()</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">slots</span><span class="p">)</span>
        <span class="n">missing</span><span class="o">.</span><span class="n">difference_update</span><span class="p">({</span><span class="s1">&#39;MW&#39;</span><span class="p">,</span> <span class="s1">&#39;CAS&#39;</span><span class="p">,</span> <span class="s1">&#39;Cn&#39;</span><span class="p">,</span> <span class="s1">&#39;Hf&#39;</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;kappa&#39;</span><span class="p">,</span> <span class="s1">&#39;LHV&#39;</span><span class="p">,</span> <span class="s1">&#39;HHV&#39;</span><span class="p">,</span> <span class="s1">&#39;epsilon&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;H_excess&#39;</span><span class="p">,</span> <span class="s1">&#39;S_excess&#39;</span><span class="p">,</span> <span class="s1">&#39;phase_ref&#39;</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">missing</span></div>
    
<div class="viewcode-block" id="Chemical.load_free_energies"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.load_free_energies">[docs]</a>    <span class="k">def</span> <span class="nf">load_free_energies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load the `H`, `S`, `H_excess`, and `S_excess` functors.&quot;&quot;&quot;</span>
        <span class="n">Cn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cn</span>
        <span class="n">single_phase</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Cn</span><span class="p">,</span> <span class="n">TDependentModelHandle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eos</span> <span class="o">=</span> <span class="n">GCEOS_DUMMY</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="mf">101325.</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eos_1atm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos</span><span class="o">.</span><span class="n">to_TP</span><span class="p">(</span><span class="mf">298.15</span><span class="p">,</span> <span class="mi">101325</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_energies</span><span class="p">(</span><span class="n">Cn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Hvap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Hfus</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tm</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Tb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_1atm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_ref</span><span class="p">,</span>
                            <span class="n">single_phase</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_ref</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Chemical.get_missing_slots"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.get_missing_slots">[docs]</a>    <span class="k">def</span> <span class="nf">get_missing_slots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list all missing thermodynamic properties.</span>
<span class="sd">        </span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from thermosteam import Chemical</span>
<span class="sd">        &gt;&gt;&gt; Substance = Chemical.blank(&#39;Substance&#39;, phase_ref=&#39;l&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Substance.get_missing_slots()</span>
<span class="sd">        [&#39;eos&#39;, &#39;eos_1atm&#39;, &#39;InChI&#39;, &#39;InChI_key&#39;, &#39;common_name&#39;, &#39;iupac_name&#39;, &#39;pubchemid&#39;, &#39;smiles&#39;, &#39;formula&#39;, &#39;Dortmund&#39;, &#39;UNIFAC&#39;, &#39;PSRK&#39;, &#39;combustion&#39;, &#39;S_excess&#39;, &#39;H_excess&#39;, &#39;mu&#39;, &#39;kappa&#39;, &#39;V&#39;, &#39;S&#39;, &#39;H&#39;, &#39;Cn&#39;, &#39;Psat&#39;, &#39;Hvap&#39;, &#39;sigma&#39;, &#39;epsilon&#39;, &#39;MW&#39;, &#39;Tm&#39;, &#39;Tb&#39;, &#39;Tt&#39;, &#39;Tc&#39;, &#39;Pt&#39;, &#39;Pc&#39;, &#39;Vc&#39;, &#39;Zc&#39;, &#39;Hf&#39;, &#39;LHV&#39;, &#39;HHV&#39;, &#39;Hfus&#39;, &#39;Hsub&#39;, &#39;omega&#39;, &#39;dipole&#39;, &#39;StielPolar&#39;, &#39;similarity_variable&#39;, &#39;iscyclic_aliphatic&#39;]</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">getfield</span> <span class="o">=</span> <span class="nb">getattr</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">slots</span> <span class="ow">or</span> <span class="n">_checked_slots</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">getfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)]</span></div>
    
<div class="viewcode-block" id="Chemical.copy_missing_slots_from"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.copy_missing_slots_from">[docs]</a>    <span class="k">def</span> <span class="nf">copy_missing_slots_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">sources</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy the missing thermodynamic properties by copying from sources. Also return any names of thermodynamic properties that are still missing.&quot;&quot;&quot;</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="n">slots</span> <span class="k">if</span> <span class="n">slots</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_missing_slots</span><span class="p">(</span><span class="n">slots</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
            <span class="n">missing</span> <span class="o">=</span> <span class="n">fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">missing</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">default</span><span class="p">:</span>
            <span class="n">missing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">missing</span><span class="p">)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked_state</span>
        <span class="k">if</span> <span class="n">phase</span><span class="p">:</span> <span class="n">lock_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">missing</span></div>
    
<div class="viewcode-block" id="Chemical.blank"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.blank">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">blank</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">CAS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">phase_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new Chemical object without any thermodynamic models or data (unless provided).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ID : str</span>
<span class="sd">            Chemical identifier.</span>
<span class="sd">        CAS : str, optional</span>
<span class="sd">            CAS number. If none provide, it defaults to the `ID`.</span>
<span class="sd">        phase_ref : str, optional</span>
<span class="sd">            Phase at the reference state (T=298.15, P=101325).</span>
<span class="sd">        phase : str, optional</span>
<span class="sd">            Phase to set state as a single phase chemical.</span>
<span class="sd">        **data : </span>
<span class="sd">            Any data to fill chemical with.</span>
<span class="sd">        </span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from thermosteam import Chemical</span>
<span class="sd">        &gt;&gt;&gt; Substance = Chemical.blank(&#39;Substance&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Substance.show()</span>
<span class="sd">        Chemical: Substance (phase_ref=None)</span>
<span class="sd">        [Names]  CAS: Substance</span>
<span class="sd">                 InChI: None</span>
<span class="sd">                 InChI_key: None</span>
<span class="sd">                 common_name: None</span>
<span class="sd">                 iupac_name: None</span>
<span class="sd">                 pubchemid: None</span>
<span class="sd">                 smiles: None</span>
<span class="sd">                 formula: None</span>
<span class="sd">        [Groups] Dortmund: &lt;Empty&gt;</span>
<span class="sd">                 UNIFAC: &lt;Empty&gt;</span>
<span class="sd">                 PSRK: &lt;Empty&gt;</span>
<span class="sd">        [Thermo] S_excess: None</span>
<span class="sd">                 H_excess: None</span>
<span class="sd">                 mu(phase, T, P) -&gt; Pa*s</span>
<span class="sd">                 kappa(phase, T, P) -&gt; W/m/K</span>
<span class="sd">                 V(phase, T, P) -&gt; m^3/mol</span>
<span class="sd">                 S: None</span>
<span class="sd">                 H: None</span>
<span class="sd">                 Cn(phase, T) -&gt; J/mol/K</span>
<span class="sd">                 Psat(T, P=None) -&gt; Pa</span>
<span class="sd">                 Hvap(T, P=None) -&gt; J/mol</span>
<span class="sd">                 sigma(T, P=None) -&gt; N/m</span>
<span class="sd">                 epsilon(T, P=None)</span>
<span class="sd">        [Data]   MW: None</span>
<span class="sd">                 Tm: None</span>
<span class="sd">                 Tb: None</span>
<span class="sd">                 Tt: None</span>
<span class="sd">                 Tc: None</span>
<span class="sd">                 Pt: None</span>
<span class="sd">                 Pc: None</span>
<span class="sd">                 Vc: None</span>
<span class="sd">                 Zc: None</span>
<span class="sd">                 Hf: None</span>
<span class="sd">                 LHV: None</span>
<span class="sd">                 HHV: None</span>
<span class="sd">                 Hfus: None</span>
<span class="sd">                 Hsub: None</span>
<span class="sd">                 omega: None</span>
<span class="sd">                 dipole: None</span>
<span class="sd">                 StielPolar: None</span>
<span class="sd">                 similarity_variable: None</span>
<span class="sd">                 iscyclic_aliphatic: None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_1atm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">setfield</span> <span class="o">=</span> <span class="nb">setattr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UNIFAC</span> <span class="o">=</span> <span class="n">UNIFACGroupCounts</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Dortmund</span> <span class="o">=</span> <span class="n">DortmundGroupCounts</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PSRK</span> <span class="o">=</span> <span class="n">PSRKGroupCounts</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_names</span><span class="p">:</span> <span class="n">setfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_reactions</span><span class="p">:</span> <span class="n">setfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_data</span><span class="p">:</span> <span class="n">setfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_free_energies</span><span class="p">:</span> <span class="n">setfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">phase</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;kappa&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">):</span>
                <span class="n">setfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">TPDependentModelHandle</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Cn</span> <span class="o">=</span> <span class="n">TDependentModelHandle</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;kappa&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">):</span>
                <span class="n">setfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">PhaseTPProperty</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Cn</span> <span class="o">=</span> <span class="n">PhaseTProperty</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;epsilon&#39;</span><span class="p">,</span> <span class="s1">&#39;Psat&#39;</span><span class="p">,</span> <span class="s1">&#39;Hvap&#39;</span><span class="p">):</span>
            <span class="n">setfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">TDependentModelHandle</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_locked_state</span> <span class="o">=</span> <span class="n">phase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ID</span> <span class="o">=</span> <span class="n">ID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase_ref</span> <span class="o">=</span> <span class="n">phase_ref</span> <span class="ow">or</span> <span class="n">phase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_CAS</span> <span class="o">=</span> <span class="n">CAS</span> <span class="ow">or</span> <span class="n">ID</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="n">setfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span> <span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>
    
<div class="viewcode-block" id="Chemical.get_phase"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.get_phase">[docs]</a>    <span class="k">def</span> <span class="nf">get_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="mf">101325.</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return phase of chemical at given thermal condition.</span>
<span class="sd">        </span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from thermosteam import Chemical</span>
<span class="sd">        &gt;&gt;&gt; Water = Chemical(&#39;Water&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Water.get_phase(T=400, P=101325)</span>
<span class="sd">        &#39;g&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_locked_state</span><span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_locked_state</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tm</span> <span class="ow">and</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tm</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;s&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psat</span> <span class="ow">and</span> <span class="n">P</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psat</span><span class="p">(</span><span class="n">T</span><span class="p">):</span> <span class="k">return</span> <span class="s1">&#39;g&#39;</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;l&#39;</span></div>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">locked_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[str] Constant phase of chemical.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_locked_state</span>
    
<div class="viewcode-block" id="Chemical.at_state"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.at_state">[docs]</a>    <span class="k">def</span> <span class="nf">at_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the state of chemical.</span>
<span class="sd">        </span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from thermosteam import Chemical</span>
<span class="sd">        &gt;&gt;&gt; N2 = Chemical(&#39;N2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; N2.at_state(phase=&#39;g&#39;)</span>
<span class="sd">        &gt;&gt;&gt; N2.show() # Note how all functors are not a function of phase anymore</span>
<span class="sd">        Chemical: N2 (phase_ref=&#39;g&#39;) at phase=&#39;g&#39;</span>
<span class="sd">        [Names]  CAS: 7727-37-9</span>
<span class="sd">                 InChI: N2/c1-2</span>
<span class="sd">                 InChI_key: IJGRMHOSHXDMSA-U...</span>
<span class="sd">                 common_name: nitrogen</span>
<span class="sd">                 iupac_name: molecular nitro...</span>
<span class="sd">                 pubchemid: 947</span>
<span class="sd">                 smiles: N#N</span>
<span class="sd">                 formula: N2</span>
<span class="sd">        [Groups] Dortmund: &lt;Empty&gt;</span>
<span class="sd">                 UNIFAC: &lt;Empty&gt;</span>
<span class="sd">                 PSRK: &lt;Empty&gt;</span>
<span class="sd">        [Thermo] S_excess(T, P) -&gt; J/mol</span>
<span class="sd">                 H_excess(T, P) -&gt; J/mol</span>
<span class="sd">                 mu(T, P) -&gt; Pa*s</span>
<span class="sd">                 kappa(T, P) -&gt; W/m/K</span>
<span class="sd">                 V(T, P) -&gt; m^3/mol</span>
<span class="sd">                 S(T, P) -&gt; J/mol</span>
<span class="sd">                 H(T, P=None) -&gt; J/mol</span>
<span class="sd">                 Cn(T, P=None) -&gt; J/mol/K</span>
<span class="sd">                 Psat(T, P=None) -&gt; Pa</span>
<span class="sd">                 Hvap(T, P=None) -&gt; J/mol</span>
<span class="sd">                 sigma(T, P=None) -&gt; N/m</span>
<span class="sd">                 epsilon(T, P=None)</span>
<span class="sd">        [Data]   MW: 28.013 g/mol</span>
<span class="sd">                 Tm: 63.15 K</span>
<span class="sd">                 Tb: 77.355 K</span>
<span class="sd">                 Tt: 63.15 K</span>
<span class="sd">                 Tc: 126.2 K</span>
<span class="sd">                 Pt: 12527 K</span>
<span class="sd">                 Pc: 3.3944e+06 Pa</span>
<span class="sd">                 Vc: 8.95e-05 m^3/mol</span>
<span class="sd">                 Zc: 0.28953</span>
<span class="sd">                 Hf: None</span>
<span class="sd">                 LHV: 0</span>
<span class="sd">                 HHV: 0</span>
<span class="sd">                 Hfus: 710 J/mol</span>
<span class="sd">                 Hsub: None</span>
<span class="sd">                 omega: 0.04</span>
<span class="sd">                 dipole: 0 Debye</span>
<span class="sd">                 StielPolar: None</span>
<span class="sd">                 similarity_variable: 0.071394</span>
<span class="sd">                 iscyclic_aliphatic: 0</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
            <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CAS</span><span class="p">)</span>
            <span class="n">new</span><span class="o">.</span><span class="n">at_state</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new</span>
        <span class="n">locked_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locked_state</span>
        <span class="k">if</span> <span class="n">locked_state</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">locked_state</span> <span class="o">!=</span> <span class="n">phase</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&#39;s state is already locked&quot;</span><span class="p">)</span>   
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span>         
        <span class="k">elif</span> <span class="n">phase</span><span class="p">:</span>
            <span class="n">lock_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid phase </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Chemical.show"><a class="viewcode-back" href="../../Chemical.html#thermosteam.Chemical.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print all specifications&quot;&quot;&quot;</span>
        <span class="n">getfield</span> <span class="o">=</span> <span class="nb">getattr</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">chemical_identity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pretty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">header</span><span class="p">,</span> <span class="n">fields</span> <span class="ow">in</span> <span class="n">_chemical_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">section</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">getfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
                <span class="n">field</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">: None&quot;</span>
                <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">display_asfunctor</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">field</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">field</span><span class="p">,</span> <span class="n">show_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.5g</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="n">units</span> <span class="o">=</span> <span class="n">chemical_units_of_measure</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">units</span><span class="p">:</span> <span class="n">line</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">units</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">27</span><span class="p">:</span> <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="mi">27</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;...&#39;</span>
                <span class="n">section</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">section</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">+=</span> <span class="n">header</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="mi">9</span><span class="o">*</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>
        
    <span class="n">_ipython_display_</span> <span class="o">=</span> <span class="n">show</span>
    
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID</span>
    
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Chemical(&#39;</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&#39;)&quot;</span></div>
    
<span class="k">def</span> <span class="nf">lock_phase</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">phase</span><span class="p">):</span>
    <span class="n">getfield</span> <span class="o">=</span> <span class="nb">getattr</span>
    <span class="n">setfield</span> <span class="o">=</span> <span class="nb">setattr</span>
    <span class="n">hasfield</span> <span class="o">=</span> <span class="nb">hasattr</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">_phase_properties</span><span class="p">:</span>
        <span class="n">phase_property</span> <span class="o">=</span> <span class="n">getfield</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hasfield</span><span class="p">(</span><span class="n">phase_property</span><span class="p">,</span> <span class="n">phase</span><span class="p">):</span>
            <span class="n">model_handle</span> <span class="o">=</span> <span class="n">getfield</span><span class="p">(</span><span class="n">phase_property</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
            <span class="n">setfield</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">model_handle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">_free_energies</span><span class="p">:</span>
        <span class="n">phase_property</span> <span class="o">=</span> <span class="n">getfield</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hasfield</span><span class="p">(</span><span class="n">phase_property</span><span class="p">,</span> <span class="n">phase</span><span class="p">):</span>
            <span class="n">functor</span> <span class="o">=</span> <span class="n">getfield</span><span class="p">(</span><span class="n">phase_property</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
            <span class="n">setfield</span><span class="p">(</span><span class="n">chemical</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">functor</span><span class="p">)</span>
    <span class="n">chemical</span><span class="o">.</span><span class="n">_locked_state</span> <span class="o">=</span> <span class="n">phase</span>

<span class="c1"># # Fire Safety Limits</span>
<span class="c1"># self.Tflash = Tflash(CAS)</span>
<span class="c1"># self.Tautoignition = Tautoignition(CAS)</span>
<span class="c1"># self.LFL = LFL(CASRN=CAS, atoms=self.atoms, Hc=self.Hc)</span>
<span class="c1"># self.UFL = UFL(CASRN=CAS, atoms=self.atoms, Hc=self.Hc)</span>

<span class="c1"># # Chemical Exposure Limits</span>
<span class="c1"># self.TWA = TWA(CASRN=CAS)</span>
<span class="c1"># self.STEL = STEL(CASRN=CAS)</span>
<span class="c1"># self.Ceiling = Ceiling(CASRN=CAS)</span>
<span class="c1"># self.Skin = Skin(CASRN=CAS)</span>
<span class="c1"># self.Carcinogen = Carcinogen(CASRN=CAS)</span>

<span class="c1"># # Misc</span>
<span class="c1"># self.dipole = dipole(CASRN=CAS) # Units of Debye</span>
<span class="c1"># self.Stockmayer = Stockmayer(CASRN=CAS, Tm=self.Tm, Tb=self.Tb, Tc=self.Tc,</span>
<span class="c1">#                               Zc=self.Zc, omega=self.omega)</span>

<span class="c1"># # Environmental</span>
<span class="c1"># self.GWP = GWP(CASRN=CAS)</span>
<span class="c1"># self.ODP = ODP(CASRN=CAS)</span>
<span class="c1"># self.logP = logP(CASRN=CAS)</span>

<span class="c1"># # Analytical</span>
<span class="c1"># self.RI, self.RIT = refractive_index(CASRN=CAS)</span>
<span class="c1"># self.conductivity, self.conductivityT = conductivity(CASRN=CAS)</span>
    
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Yoel Cortes-Pena

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>